async function askForGeoJSON() {
    let promise;
    // delete IP
    const mapBounds = map.getBounds();
    const southWestLat = mapBounds.getSouthWest().lat;
    const southWestLng = mapBounds.getSouthWest().lng;
    const northEastLat = mapBounds.getNorthEast().lat;
    const northEastLng = mapBounds.getNorthEast().lng;
    const bb = southWestLat.toString() + "," + southWestLng.toString() + ","
        + northEastLat.toString() + "," + northEastLng.toString();
    console.log(bb);

    if (typeof promise !== 'undefined'){
        promise.abort();
    }

    // const jsonData = [{"geometry":
    //         {"coordinates":[20.975184976060735,52.21175940525132],"type":"Point"},
    //     "properties":{
    //         "cut_out_reason":"posing a threat",
    //         "inventory_number":"D232140",
    //         "management_unit":"Zarz\u0105d Zieleni m.st. Warszawy",
    //         "name":"Numer inwentaryzacyjny: D232140\nNazwa polska: topola czarna\nNazwa \u0142aci\u0144ska: Populus nigra\nObw\u00f3d pnia w cm: 171, 132\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.03.2019\nInformacje dodatkowe: ",
    //         "species":"topola czarna",
    //         "status":"request",
    //         "updated":"27.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.974314811099372,52.212069625602986],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D232152","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D232152\nNazwa polska: topola Simona\nNazwa \u0142aci\u0144ska: Populus simonii\nObw\u00f3d pnia w cm: 132\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.03.2019\nInformacje dodatkowe: ","species":"topola Simona","status":"request","updated":"27.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.973669077601905,52.212278221517316],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D232173","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D232173\nNazwa polska: topola czarna\nNazwa \u0142aci\u0144ska: Populus nigra\nObw\u00f3d pnia w cm: 86, 80\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.03.2019\nInformacje dodatkowe: ","species":"topola czarna","status":"request","updated":"27.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.973350800843466,52.2124004092577],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D232182","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D232182\nNazwa polska: topola  sp.\nNazwa \u0142aci\u0144ska: Populus  sp.\nObw\u00f3d pnia w cm: 103\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.03.2019\nInformacje dodatkowe: ","species":"topola  sp.","status":"request","updated":"27.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.977319750811656,52.21233517349943],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D235855","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D235855\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nObw\u00f3d pnia w cm: 112\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.03.2019\nInformacje dodatkowe: ","species":"klon pospolity","status":"request","updated":"27.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.973283562390808,52.207653080082],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D235886","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D235886\nNazwa polska: jesion wynios\u0142y\nNazwa \u0142aci\u0144ska: Fraxinus excelsior\nObw\u00f3d pnia w cm: 209\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 24.10.2018\nInformacje dodatkowe: ","species":"jesion wynios\u0142y","status":"request","updated":"24.10.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.973874570547014,52.211916221677136],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D232412","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D232412\nNazwa polska: jesion wynios\u0142y\nNazwa \u0142aci\u0144ska: Fraxinus excelsior\nObw\u00f3d pnia w cm: 117\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 04.03.2019\nInformacje dodatkowe: ","species":"jesion wynios\u0142y","status":"accepted","updated":"04.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.974931672711733,52.211388570108724],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D232421","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D232421\nNazwa polska: jesion wynios\u0142y\nNazwa \u0142aci\u0144ska: Fraxinus excelsior\nObw\u00f3d pnia w cm: 110\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 04.03.2019\nInformacje dodatkowe: ","species":"jesion wynios\u0142y","status":"accepted","updated":"04.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.97546591112481,52.21124116675476],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D232434","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D232434\nNazwa polska: klon jesionolistny\nNazwa \u0142aci\u0144ska: Acer negundo\nObw\u00f3d pnia w cm: 235\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 04.03.2019\nInformacje dodatkowe: ","species":"klon jesionolistny","status":"accepted","updated":"04.03.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.9739147541164,52.20834232534357],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D235876","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D235876\nNazwa polska: klon jesionolistny\nNazwa \u0142aci\u0144ska: Acer negundo\nObw\u00f3d pnia w cm: 177\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 02.04.2019\nInformacje dodatkowe: ","species":"klon jesionolistny","status":"accepted","updated":"02.04.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.973134330691494,52.20751389268114],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D235890","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D235890\nNazwa polska: jesion wynios\u0142y\nNazwa \u0142aci\u0144ska: Fraxinus excelsior\nObw\u00f3d pnia w cm: 288\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 02.04.2019\nInformacje dodatkowe: ","species":"jesion wynios\u0142y","status":"accepted","updated":"02.04.2019"},"type":"Feature"},{"geometry":{"coordinates":[20.966197898938184,52.211818000641536],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D607115","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D607115\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.966164244829237,52.211785174100044],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D607116","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D607116\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.970814619546942,52.20628908528048],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608399","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608399\nNazwa polska: lipa srebrzysta \"Brabant\"\nNazwa \u0142aci\u0144ska: Tilia tomentosa 'Brabant'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"lipa srebrzysta \"Brabant\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.970885464130827,52.20627126751135],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608400","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608400\nNazwa polska: lipa srebrzysta \"Brabant\"\nNazwa \u0142aci\u0144ska: Tilia tomentosa 'Brabant'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"lipa srebrzysta \"Brabant\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.966985201980197,52.20759431702528],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608403","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608403\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.967015361769427,52.20763855680482],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608404","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608404\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.967146561053674,52.20766498948301],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608405","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608405\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.974724907134092,52.20933320698831],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D607906","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D607906\nNazwa polska: lipa srebrzysta \"Brabant\"\nNazwa \u0142aci\u0144ska: Tilia tomentosa 'Brabant'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"lipa srebrzysta \"Brabant\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.972798219049153,52.20710958145126],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608223","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608223\nNazwa polska: lipa srebrzysta \"Brabant\"\nNazwa \u0142aci\u0144ska: Tilia tomentosa 'Brabant'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"lipa srebrzysta \"Brabant\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.969381555504015,52.20693841608465],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608239","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608239\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.9694512455035,52.206912751685316],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608240","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608240\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.969519384382252,52.2068918431547],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608241","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608241\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.96958597200048,52.206873787791515],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608242","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608242\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.96965720973305,52.206850025474374],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608243","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608243\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.969734642571737,52.20682246109257],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608244","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608244\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.969810522201687,52.20680060257703],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608245","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608245\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.969886405149236,52.20677589040683],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608246","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608246\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.969960740051068,52.20674927598847],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608247","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608247\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.970047461310298,52.20672076196343],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608248","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608248\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.97012644146257,52.20669319681792],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608249","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608249\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.970208519172267,52.20666468149878],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608250","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608250\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.970285950079102,52.206639018559265],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608251","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608251\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.9703726723785,52.20661050429499],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608252","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608252\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.97045319927803,52.20658389112007],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608253","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608253\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.970525984488173,52.20655917776219],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608254","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608254\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.970601866420456,52.20653256242666],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608255","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608255\nNazwa polska: magnolia \"Galaxy\"\nNazwa \u0142aci\u0144ska: Magnolia 'Galaxy'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"magnolia \"Galaxy\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.965583038638574,52.208202707926176],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608260","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608260\nNazwa polska: klon polny\nNazwa \u0142aci\u0144ska: Acer campestre\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon polny","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.965879231824783,52.208103511810585],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608261","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608261\nNazwa polska: klon polny\nNazwa \u0142aci\u0144ska: Acer campestre\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon polny","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.965813412225078,52.20812489525741],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608262","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608262\nNazwa polska: klon polny\nNazwa \u0142aci\u0144ska: Acer campestre\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon polny","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.965748560047437,52.20814568396016],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608263","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608263\nNazwa polska: klon polny\nNazwa \u0142aci\u0144ska: Acer campestre\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon polny","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.965666283641617,52.20817419611314],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608264","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608264\nNazwa polska: klon polny\nNazwa \u0142aci\u0144ska: Acer campestre\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon polny","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.967726192451074,52.20741831202223],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608406","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608406\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.96849398408835,52.2070996273993],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608407","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608407\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.968773857221663,52.20706973846501],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D608408","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D608408\nNazwa polska: klon pospolity\nNazwa \u0142aci\u0144ska: Acer platanoides\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"klon pospolity","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.977954303809778,52.206573976085814],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611014","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611014\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.97806106260947,52.206718817192495],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611015","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611015\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.97810052066932,52.20676662220715],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611016","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611016\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.978316406008307,52.20696998176153],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611017","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611017\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.978256060836316,52.20689292328258],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611018","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611018\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.978726106435698,52.20740166541686],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611019","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611019\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.978753963874187,52.207429493770526],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611020","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611020\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.97877485285285,52.20745517998566],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611021","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611021\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.978800384126906,52.20748942784974],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611022","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611022\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.978824755548477,52.20752010826747],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D611023","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D611023\nNazwa polska: grab pospolity \"Fastigiata\"\nNazwa \u0142aci\u0144ska: Carpinus betulus 'Fastigiata'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 30.11.2018","species":"grab pospolity \"Fastigiata\"","status":"replacement","updated":"30.11.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.96647849266625,52.20752275853428],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D589261","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D589261\nNazwa polska: jarz\u0105b \"Flanrock\"\nNazwa \u0142aci\u0144ska: Sorbus 'Flanrock'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.09.2018","species":"jarz\u0105b \"Flanrock\"","status":"replacement","updated":"27.09.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.96643638815158,52.20753523143211],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D589262","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D589262\nNazwa polska: jarz\u0105b \"Flanrock\"\nNazwa \u0142aci\u0144ska: Sorbus 'Flanrock'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.09.2018","species":"jarz\u0105b \"Flanrock\"","status":"replacement","updated":"27.09.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.966512852390082,52.20751206748979],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D589263","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D589263\nNazwa polska: jarz\u0105b \"Flanrock\"\nNazwa \u0142aci\u0144ska: Sorbus 'Flanrock'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.09.2018","species":"jarz\u0105b \"Flanrock\"","status":"replacement","updated":"27.09.2018"},"type":"Feature"},{"geometry":{"coordinates":[20.97455538406606,52.21200508919432],"type":"Point"},"properties":{"cut_out_reason":"posing a threat","inventory_number":"D589267","management_unit":"Zarz\u0105d Zieleni m.st. Warszawy","name":"Numer inwentaryzacyjny: D589267\nNazwa polska: topola ameryka\u0144ska \"Purple Tower\"\nNazwa \u0142aci\u0144ska: Populus deltoides 'Purple Tower'\nJednostka zarz\u0105dzaj\u0105ca: Zarz\u0105d Zieleni m.st. Warszawy\nAktualno\u015b\u0107 danych na dzie\u0144: 27.09.2018","species":"topola ameryka\u0144ska \"Purple Tower\"","status":"replacement","updated":"27.09.2018"},"type":"Feature"}];
    // addMarkersToMap(jsonData);


    promise = $.get("http://10.144.3.210:5000/trees.json",
        {bb: bb},
        function (jsonData) {
            addMarkersToMap(jsonData);
            console.log(jsonData, "jsonDATA");
        })
        .fail(function () {
            console.log("ERROR OCCURED")
        });


}

function addMarkersToMap(treeJsonData) {
    let trees = [];
    map.eachLayer(function (layer) {
       if (layer._leaflet_id !== 26){
           map.removeLayer(layer);
       }
    });
    treeJsonData.forEach(treeJson => {
        let fillColor = "#ff7800";
        let color = "#fff";
        const point = L.geoJson(treeJson, {
            style: function (feature) {
                return feature.properties && feature.properties.style;
            },
            pointToLayer: function (feature, latlng) {
                if (feature.properties.status){
                    console.log("status", feature.properties.status);
                    switch (feature.properties.status) {
                        case "replacement":
                            fillColor = "#00ff66";
                            break;
                        case "request":
                            fillColor = "#ff3333";
                            break;
                        case "accepted":
                            fillColor = "#0066cc";
                            break;
                        default:
                            fillColor = "#ff7800";
                    }
                }
                return L.circleMarker(latlng, {
                    radius: 8,
                    fillColor: fillColor,
                    color: color,
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.8
                }).on('click', function (options) {
                    $( ".sidebar" ).css({'opacity': '1'});
                    updateSidebar(options.sourceTarget.feature);
                });
            }
        });
        trees.push(point);
    });

    const treesLayer = L.layerGroup(trees);
    treesLayer.addTo(map)
}